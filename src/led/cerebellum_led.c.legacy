#include <lib/cerebellum/led.h>

/**
 * Parsing of kcnf configuration entries
 */

#ifdef CONFIG_ARCH_AVR

#ifdef CONFIG_CONTRIB_CEREBELLUM_MOD_LED_1
        #if defined(CONFIG_CONTRIB_CEREBELLUM_MOD_LED_1_GPIO_A)
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_1_DDR DDRA
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_1_PORT PORTA
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_1_PIN PINA
        #elif defined(CONFIG_CONTRIB_CEREBELLUM_MOD_LED_1_GPIO_B)
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_1_DDR DDRB
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_1_PORT PORTB
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_1_PIN PINB
        #elif defined(CONFIG_CONTRIB_CEREBELLUM_MOD_LED_1_GPIO_C)
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_1_DDR DDRC
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_1_PORT PORTC
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_1_PIN PINC
        #elif defined(CONFIG_CONTRIB_CEREBELLUM_MOD_LED_1_GPIO_D)
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_1_DDR DDRD
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_1_PORT PORTD
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_1_PIN PIND
        #elif defined(CONFIG_CONTRIB_CEREBELLUM_MOD_LED_1_GPIO_E)
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_1_DDR DDRE
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_1_PORT PORTE
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_1_PIN PINE
        #elif defined(CONFIG_CONTRIB_CEREBELLUM_MOD_LED_1_GPIO_F)
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_1_DDR DDRF
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_1_PORT PORTF
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_1_PIN PINF
        #elif defined(CONFIG_CONTRIB_CEREBELLUM_MOD_LED_1_GPIO_G)
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_1_DDR DDRG
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_1_PORT PORTG
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_1_PIN PING
        #elif defined(CONFIG_CONTRIB_CEREBELLUM_MOD_LED_1_GPIO_H)
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_1_DDR DDRH
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_1_PORT PORTH
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_1_PIN PINH
        #endif
#endif

#ifdef CONFIG_CONTRIB_CEREBELLUM_MOD_LED_2
        #if defined(CONFIG_CONTRIB_CEREBELLUM_MOD_LED_2_GPIO_A)
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_2_DDR DDRA
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_2_PORT PORTA
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_2_PIN PINA
        #elif defined(CONFIG_CONTRIB_CEREBELLUM_MOD_LED_2_GPIO_B)
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_2_DDR DDRB
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_2_PORT PORTB
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_2_PIN PINB
        #elif defined(CONFIG_CONTRIB_CEREBELLUM_MOD_LED_2_GPIO_C)
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_2_DDR DDRC
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_2_PORT PORTC
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_2_PIN PINC
        #elif defined(CONFIG_CONTRIB_CEREBELLUM_MOD_LED_2_GPIO_D)
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_2_DDR DDRD
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_2_PORT PORTD
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_2_PIN PIND
        #elif defined(CONFIG_CONTRIB_CEREBELLUM_MOD_LED_2_GPIO_E)
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_2_DDR DDRE
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_2_PORT PORTE
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_2_PIN PINE
        #elif defined(CONFIG_CONTRIB_CEREBELLUM_MOD_LED_2_GPIO_F)
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_2_DDR DDRF
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_2_PORT PORTF
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_2_PIN PINF
        #elif defined(CONFIG_CONTRIB_CEREBELLUM_MOD_LED_2_GPIO_G)
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_2_DDR DDRG
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_2_PORT PORTG
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_2_PIN PING
        #elif defined(CONFIG_CONTRIB_CEREBELLUM_MOD_LED_2_GPIO_H)
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_2_DDR DDRH
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_2_PORT PORTH
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_2_PIN PINH
        #endif
#endif

#ifdef CONFIG_CONTRIB_CEREBELLUM_MOD_LED_3
        #if defined(CONFIG_CONTRIB_CEREBELLUM_MOD_LED_3_GPIO_A)
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_3_DDR DDRA
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_3_PORT PORTA
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_3_PIN PINA
        #elif defined(CONFIG_CONTRIB_CEREBELLUM_MOD_LED_3_GPIO_B)
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_3_DDR DDRB
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_3_PORT PORTB
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_3_PIN PINB
        #elif defined(CONFIG_CONTRIB_CEREBELLUM_MOD_LED_3_GPIO_C)
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_3_DDR DDRC
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_3_PORT PORTC
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_3_PIN PINC
        #elif defined(CONFIG_CONTRIB_CEREBELLUM_MOD_LED_3_GPIO_D)
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_3_DDR DDRD
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_3_PORT PORTD
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_3_PIN PIND
        #elif defined(CONFIG_CONTRIB_CEREBELLUM_MOD_LED_3_GPIO_E)
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_3_DDR DDRE
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_3_PORT PORTE
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_3_PIN PINE
        #elif defined(CONFIG_CONTRIB_CEREBELLUM_MOD_LED_3_GPIO_F)
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_3_DDR DDRF
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_3_PORT PORTF
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_3_PIN PINF
        #elif defined(CONFIG_CONTRIB_CEREBELLUM_MOD_LED_3_GPIO_G)
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_3_DDR DDRG
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_3_PORT PORTG
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_3_PIN PING
        #elif defined(CONFIG_CONTRIB_CEREBELLUM_MOD_LED_3_GPIO_H)
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_3_DDR DDRH
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_3_PORT PORTH
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_3_PIN PINH
        #endif
#endif

#ifdef CONFIG_CONTRIB_CEREBELLUM_MOD_LED_4
        #if defined(CONFIG_CONTRIB_CEREBELLUM_MOD_LED_4_GPIO_A)
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_4_DDR DDRA
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_4_PORT PORTA
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_4_PIN PINA
        #elif defined(CONFIG_CONTRIB_CEREBELLUM_MOD_LED_4_GPIO_B)
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_4_DDR DDRB
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_4_PORT PORTB
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_4_PIN PINB
        #elif defined(CONFIG_CONTRIB_CEREBELLUM_MOD_LED_4_GPIO_C)
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_4_DDR DDRC
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_4_PORT PORTC
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_4_PIN PINC
        #elif defined(CONFIG_CONTRIB_CEREBELLUM_MOD_LED_4_GPIO_D)
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_4_DDR DDRD
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_4_PORT PORTD
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_4_PIN PIND
        #elif defined(CONFIG_CONTRIB_CEREBELLUM_MOD_LED_4_GPIO_E)
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_4_DDR DDRE
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_4_PORT PORTE
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_4_PIN PINE
        #elif defined(CONFIG_CONTRIB_CEREBELLUM_MOD_LED_4_GPIO_F)
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_4_DDR DDRF
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_4_PORT PORTF
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_4_PIN PINF
        #elif defined(CONFIG_CONTRIB_CEREBELLUM_MOD_LED_4_GPIO_G)
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_4_DDR DDRG
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_4_PORT PORTG
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_4_PIN PING
        #elif defined(CONFIG_CONTRIB_CEREBELLUM_MOD_LED_4_GPIO_H)
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_4_DDR DDRH
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_4_PORT PORTH
                #define CONFIG_CONTRIB_CEREBELLUM_MOD_LED_4_PIN PINH
        #endif
#endif

#define LED_ON(n) (CONFIG_CONTRIB_CEREBELLUM_MOD_LED_PORT_##n |= (1 << CONFIG_CONTRIB_CEREBELLUM_MOD_LED_PN_##n))
#define LED_OFF(n) (CONFIG_CONTRIB_CEREBELLUM_MOD_LED_##(n)_PORT &= ~(1 << CONFIG_CONTRIB_CEREBELLUM_MOD_LED_##(n)_PN))
#define LED_STATE(n) ((CONFIG_CONTRIB_CEREBELLUM_MOD_LED_##(n)_PIN & (1 << CONFIG_CONTRIB_CEREBELLUM_MOD_LED_##(n)_PN)) != 0)

#endif

/* Source code */
/*
void led_init(void)
{
#ifdef ARCH_AVR
        #ifdef CONFIG_CONTRIB_CEREBELLUM_MOD_LED_1
        CONFIG_CONTRIB_CEREBELLUM_MOD_LED_1_DDR |= (1<<CONFIG_CONTRIB_CEREBELLUM_MOD_LED_1_PN);
        #endif
        #ifdef CONFIG_CONTRIB_CEREBELLUM_MOD_LED_2
        CONFIG_CONTRIB_CEREBELLUM_MOD_LED_2_DDR |= (1<<CONFIG_CONTRIB_CEREBELLUM_MOD_LED_2_PN);
        #endif
        #ifdef CONFIG_CONTRIB_CEREBELLUM_MOD_LED_3
        CONFIG_CONTRIB_CEREBELLUM_MOD_LED_3_DDR |= (1<<CONFIG_CONTRIB_CEREBELLUM_MOD_LED_3_PN);
        #endif
        #ifdef CONFIG_CONTRIB_CEREBELLUM_MOD_LED_4
        CONFIG_CONTRIB_CEREBELLUM_MOD_LED_4_DDR |= (1<<CONFIG_CONTRIB_CEREBELLUM_MOD_LED_4_PN);
        #endif
#endif
}
*/

/*
void led_on(led_t led)
{
        switch(led)
        {
                case 1:
                        LED_ON(1);
                        break;
                case 2:
                        LED_ON(2);
                        break;
                case 3:
                        LED_ON(3);
                        break;
                case 4:
                        LED_ON(4);
                        break;
                default:
                        /* TODO: insert ASSERTION_FAILED macros etc */
                        return;
        }
}

void led_off(led_t led)
{
        switch(led)
        {
                case 1:
                        LED_OFF(1);
                        break;
                case 2:
                        LED_OFF(2);
                        break;
                case 3:
                        LED_OFF(3);
                        break;
                case 4:
                        LED_OFF(4);
                        break;
                default:
                        /* TODO: insert ASSERTION_FAILED macros etc */
                        return;
        }
}

led_state_t led_state(led_t led)
{
        switch(led)
        {
                case 1:
                        return LED_STATE(1);
                        break;
                case 2:
                        return LED_STATE(2);
                        break;
                case 3:
                        return LED_STATE(3);
                        break;
                case 4:
                        return LED_STATE(4);
                        break;
                default:
                        /* TODO: insert ASSERTION_FAILED macros etc */
                        return 0;
        }
}

void led_write(led_t led, led_state_t value)
{
        if (value)
                led_on(led);
        else
                led_off(led);
}

void led_toggle(led_t led)
{
        led_write(led, !led_state(led));
}
*/
